# Калькулятор параметров экрана (VL-Calc)

## Описание
VL-Calc — это приложение с графическим интерфейсом, разработанное на Python с использованием библиотеки tkinter. Программа предназначена для расчёта параметров светодиодных экранов, включая количество модулей, приёмных карт, блоков питания, а также энергопотребление (DC и AC). Она позволяет пользователям вводить параметры экрана, модулей, приёмных карт и блоков питания, а затем вычисляет и отображает результаты с высокой точностью (до трёх знаков после запятой).

### Основные функции:
- Расчёт размеров экрана и количества модулей.
- Определение общего разрешения и плотности пикселей.
- Расчёт количества необходимых приёмных карт.
- Вычисление энергопотребления (DC и AC) для модуля, квадратного метра и всего экрана.
- Расчёт общего, среднего и среднего минимального потребления AC.
- Поддержка иконки приложения (VL.ico) для Windows.

## Требования
- **Python:** 3.8–3.11 (рекомендуется 3.11 для стабильной работы с PyInstaller).
- **Библиотеки:**
  - tkinter (обычно встроена в Python).
  - PyInstaller (для сборки в .exe): установить с помощью `pip install pyinstaller`.
- **Файл иконки:** VL.ico (должен находиться в той же папке, что и скрипт).
- **Операционная система:** Windows (для .exe сборки).

## Установка
1. Убедитесь, что Python установлен:
   ```bash
   python --version
   ```
   Если Python не установлен, скачайте и установите его с [официального сайта](https://www.python.org/downloads/).
2. Установите PyInstaller (если планируете собирать .exe):
   ```bash
   pip install pyinstaller
   ```
3. Скачайте или скопируйте файл `VL-Calc.py` и `VL.ico` в одну папку (например, `C:\Users\ВашеИмя\Desktop\VL-Calc`).

## Использование
### Запуск скрипта:
1. Откройте терминал (или командную строку) и перейдите в папку с файлом:
   ```bash
   cd C:\Users\ВашеИмя\Desktop\VL-Calc
   ```
2. Запустите скрипт:
   ```bash
   python VL-Calc.py
   ```

### Интерфейс:
- Введите параметры в соответствующие поля:
  - **Экран:** ширина и высота экрана (в метрах).
  - **Модуль:** ширина, высота, шаг пикселя, разрешение по ширине и высоте, потребление (в амперах).
  - **Приёмная карта:** ширина и высота кабинета (в пикселях), количество портов, модулей в цепочке.
  - **Блоки питания:** напряжение, мощность, запас мощности (в ваттах).
- Нажмите кнопку **Рассчитать** для получения результатов.

### Результаты:
- Результаты отображаются в текстовом поле справа с точностью до трёх знаков после запятой.
- Включают:
  - Количество модулей и площадь экрана.
  - Общее разрешение и плотность пикселей.
  - Количество приёмных карт.
  - Потребление (DC и AC) на модуль и квадратный метр.
  - Параметры блоков питания.
  - Общее, среднее и среднее минимальное потребление AC.

## Сборка в .exe
Чтобы создать исполняемый файл для Windows:
1. Откройте командную строку от имени администратора:
   - Нажмите Win + S, введите `cmd`, щёлкните правой кнопкой и выберите «Запуск от имени администратора».
2. Перейдите в папку с файлом:
   ```bash
   cd C:\Users\ВашеИмя\Desktop\VL-Calc
   ```
3. Удалите старые файлы сборки (если есть):
   ```bash
   rmdir /s /q build dist
   del VL-Calc.spec
   ```
4. Выполните команду PyInstaller:
   ```bash
   pyinstaller --onefile --windowed --icon=VL.ico --add-data "VL.ico;." VL-Calc.py
   ```
5. Найдите файл `VL-Calc.exe` в папке `dist`.

### Примечания:
- Убедитесь, что файл `VL.ico` находится в той же папке, что и `VL-Calc.py`.
- Если возникает ошибка PermissionError, проверьте, закрыт ли `VL-Calc.exe` в диспетчере задач, и запустите команду от администратора.
- Антивирус может блокировать .exe — добавьте папку `dist` в исключения.

## Устранение неполадок
- **Ошибка "bitmap VL.ico not defined":**
  - Проверьте, что `VL.ico` находится в папке с `VL-Calc.py` или `VL-Calc.exe`.
  - Убедитесь, что файл имеет формат .ico.
- **Ошибка "PermissionError: [WinError 5] Отказано в доступе":**
  - Запустите PyInstaller от имени администратора.
  - Закройте все экземпляры `VL-Calc.exe` в диспетчере задач.
  - Удалите папку `dist` перед новой сборкой.
- **Результаты не отображаются или некорректны:**
  - Проверьте правильность введённых данных (например, потребление модуля не должно быть 0).
  - Убедитесь, что используются запятые или точки для дробных чисел.

## Пример ввода
- **Экран:** Ширина = 5.76 м, Высота = 2.88 м
- **Модуль:** Ширина = 320 мм, Высота = 160 мм, Шаг пикселя = 6.67 мм, Разрешение = 48×24 px, Потребление = 8 А
- **Приёмная карта:** Ширина кабинета = 96 px, Высота кабинета = 216 px, Портов = 12, Модулей в цепочке = 2
- **Блоки питания:** Напряжение = 5 В, Мощность = 350 Вт, Запас = 100 Вт

## История изменений

### Версия 1.1
- Интерфейс результатов переработан: теперь результаты выводятся в виде таблицы с отдельными полями для каждого параметра (readonly Entry), а не в одном текстовом поле.
- Добавлена возможность копировать отдельные значения результатов.
- Улучшено форматирование чисел: целые значения выводятся без дробной части, дробные — с тремя знаками после запятой.
- Улучшена обработка ошибок при вводе данных.
- Добавлена поддержка копирования значения из ячеек результатов по Ctrl+C.
- Добавлена поддержка вставки значения в поля ввода по Ctrl+V.

